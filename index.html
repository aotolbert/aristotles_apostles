<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Who's your Government?</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <style>
            #map {
                height: 400px;
                /* The height is 400 pixels */
                width: 75%;
                /* The width is the width of the web page */
            }
        </style>
</head>
<body>
        <div class="container">
                <div class="row">
                    <h2>ProPublica Rocks!</h2>
                    <div class="col-sm-12">
                        <form class="mb-5" id="ppform">
                            <div class="form-group">
                              <label for="ppaddressline1">Address 1</label>
                              <input type="text" class="form-control" id="ppaddressline1" placeholder="Enter street address">
                            </div>
                            <div class="form-group">
                              <label for="ppaddressline2">Address 2</label>
                              <input type="text" class="form-control" id="ppaddressline2" placeholder="Optional">
                            </div>
                            <div class="form-row">
                                    <div class="form-group col-md-6">
                                      <label for="ppinputCity">City</label>
                                      <input type="text" class="form-control" id="ppinputCity">
                                    </div>
                                    <div class="form-group col-sm-4">
                                            <label for="ppstates">State</label>
                                            <select class="form-control" id="ppstates">
                                                    <option value="">N/A</option>
                                                    <option value="AL">Alabama</option>
                                                    <option value="AK">Alaska</option>
                                                    <option value="AZ">Arizona</option>
                                                    <option value="AR">Arkansas</option>
                                                    <option value="CA">California</option>
                                                    <option value="CO">Colorado</option>
                                                    <option value="CT">Connecticut</option>
                                                    <option value="DC">District of Columbia</option>
                                                    <option value="DE">Delaware</option>
                                                    <option value="FL">Florida</option>
                                                    <option value="GA">Georgia</option>
                                                    <option value="HI">Hawaii</option>
                                                    <option value="IA">Iowa</option>
                                                    <option value="ID">Idaho</option>
                                                    <option value="IL">Illinois</option>
                                                    <option value="IN">Indiana</option>
                                                    <option value="KS">Kansas</option>
                                                    <option value="KY">Kentucky</option>
                                                    <option value="LA">Louisiana</option>
                                                    <option value="MA">Massachusetts</option>
                                                    <option value="MD">Maryland</option>
                                                    <option value="ME">Maine</option>
                                                    <option value="MI">Michigan</option>
                                                    <option value="MN">Minnesota</option>
                                                    <option value="MO">Missouri</option>
                                                    <option value="MS">Mississippi</option>
                                                    <option value="MT">Montana</option>
                                                    <option value="NC">North Carolina</option>
                                                    <option value="ND">North Dakota</option>
                                                    <option value="NE">Nebraska</option>
                                                    <option value="NH">New Hampshire</option>
                                                    <option value="NJ">New Jersey</option>
                                                    <option value="NM">New Mexico</option>
                                                    <option value="NV">Nevada</option>
                                                    <option value="NY">New York</option>
                                                    <option value="OH">Ohio</option>
                                                    <option value="OK">Oklahoma</option>
                                                    <option value="OR">Oregon</option>
                                                    <option value="PA">Pennsylvania</option>
                                                    <option value="PR">Puerto Rico</option>
                                                    <option value="RI">Rhode Island</option>
                                                    <option value="SC">South Carolina</option>
                                                    <option value="SD">South Dakota</option>
                                                    <option value="TN">Tennessee</option>
                                                    <option value="TX">Texas</option>
                                                    <option value="UT">Utah</option>
                                                    <option value="VA">Virginia</option>
                                                    <option value="VT">Vermont</option>
                                                    <option value="WA">Washington</option>
                                                    <option value="WI">Wisconsin</option>
                                                    <option value="WV">West Virginia</option>
                                                    <option value="WY">Wyoming</option>
                                            </select>
                                        </div>
                                    <div class="form-group col-md-2">
                                      <label for="ppinputzip">Zip</label>
                                      <input type="text" class="form-control" id="ppinputzip">
                                    </div>

                            </div>  
                            <button type="submit" class="btn btn-primary" id="submitpp">Submit</button>
                        </form>
                    </div>
                </div>
            </div>

               <div class="container" id="ppdumpsite">
                
               </div> 

        <div class="container">
            <div class="row mt-5">
                    <h2>OpenStates Kicks ProPublica's Ass!</h2>
                    <div class="col-sm-12">
                        <form class="mb-5" id="osform">
                            <div class="form-group">
                              <label for="osaddressline1">Address 1</label>
                              <input type="text" class="form-control" id="osaddressline1" placeholder="Enter street address">
                            </div>
                            <div class="form-group">
                              <label for="osaddressline2">Address 2</label>
                              <input type="text" class="form-control" id="osaddressline2" placeholder="Optional">
                            </div>
                            <div class="form-row">
                                    <div class="form-group col-md-6">
                                      <label for="osinputCity">City</label>
                                      <input type="text" class="form-control" id="osinputCity">
                                    </div>
                                    <div class="form-group col-sm-4">
                                            <label for="osstates">State</label>
                                            <select class="form-control" id="osstates">
                                                    <option value="">N/A</option>
                                                    <option value="AL">Alabama</option>
                                                    <option value="AK">Alaska</option>
                                                    <option value="AZ">Arizona</option>
                                                    <option value="AR">Arkansas</option>
                                                    <option value="CA">California</option>
                                                    <option value="CO">Colorado</option>
                                                    <option value="CT">Connecticut</option>
                                                    <option value="DC">District of Columbia</option>
                                                    <option value="DE">Delaware</option>
                                                    <option value="FL">Florida</option>
                                                    <option value="GA">Georgia</option>
                                                    <option value="HI">Hawaii</option>
                                                    <option value="IA">Iowa</option>
                                                    <option value="ID">Idaho</option>
                                                    <option value="IL">Illinois</option>
                                                    <option value="IN">Indiana</option>
                                                    <option value="KS">Kansas</option>
                                                    <option value="KY">Kentucky</option>
                                                    <option value="LA">Louisiana</option>
                                                    <option value="MA">Massachusetts</option>
                                                    <option value="MD">Maryland</option>
                                                    <option value="ME">Maine</option>
                                                    <option value="MI">Michigan</option>
                                                    <option value="MN">Minnesota</option>
                                                    <option value="MO">Missouri</option>
                                                    <option value="MS">Mississippi</option>
                                                    <option value="MT">Montana</option>
                                                    <option value="NC">North Carolina</option>
                                                    <option value="ND">North Dakota</option>
                                                    <option value="NE">Nebraska</option>
                                                    <option value="NH">New Hampshire</option>
                                                    <option value="NJ">New Jersey</option>
                                                    <option value="NM">New Mexico</option>
                                                    <option value="NV">Nevada</option>
                                                    <option value="NY">New York</option>
                                                    <option value="OH">Ohio</option>
                                                    <option value="OK">Oklahoma</option>
                                                    <option value="OR">Oregon</option>
                                                    <option value="PA">Pennsylvania</option>
                                                    <option value="PR">Puerto Rico</option>
                                                    <option value="RI">Rhode Island</option>
                                                    <option value="SC">South Carolina</option>
                                                    <option value="SD">South Dakota</option>
                                                    <option value="TN">Tennessee</option>
                                                    <option value="TX">Texas</option>
                                                    <option value="UT">Utah</option>
                                                    <option value="VA">Virginia</option>
                                                    <option value="VT">Vermont</option>
                                                    <option value="WA">Washington</option>
                                                    <option value="WI">Wisconsin</option>
                                                    <option value="WV">West Virginia</option>
                                                    <option value="WY">Wyoming</option>
                                            </select>
                                        </div>
                                    <div class="form-group col-md-2">
                                      <label for="osinputZip">Zip</label>
                                      <input type="text" class="form-control" id="osinputZip">
                                    </div>

                            </div>  
                            <button type="submit" class="btn btn-primary" id="submitos">Submit</button>
                        </form>
                    </div>
                </div>
        

                <div class="row mt-5 mb-5">
                        <h2>Open States Latitude and Longitue Functionality</h2>
                        <div class="col-sm-12">
                            <form class="mb-5">
                                <div class="form-row"></div>
                                <div class="form-group col-sm-6">
                                  <label for="latitudeinput">Latitude</label>    
                                  <input type="text" class="form-control" id="latitudeinput" placeholder="Latitude">    
                                </div>
                                <div class="form-group col-sm-6">
                                        <label for="longitudeinput">Longitude</label>    
                                        <input type="text" class="form-control" id="longitudeinput" placeholder="Longitude">    
                                      </div>

                        </div>

                            <button type="submit" class="btn btn-primary" id="submitgeo">Submit</button>
                </div>
            </div>


        <div class="container" id="osdumpsite">
                
        </div> 


        <div class="container">


                <button id="submitos">Sumbit Open States</button>
            
                <h2>Google Maps API</h2>
                <div id="floating-panel">
                        <input id="address" type="textbox" value="Charlotte, NC">
                        <input id="submit" type="button" value="Locate">
                      </div>
            <div class="mr-auto ml-auto mb-5" id="map"></div>
            




<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script>

var address;

var PPAPIKey = "TQ2hslbjh61kVID2GwEOjzuQ8BzIauJScUHBfzJa";

// var PPqueryURL = "https://api.propublica.org/congress/v1/members/senate/" + stateInput + "/current.json";

var OSAPIKey = "61090add-67ca-4358-841d-7983d3231aa0";

// var OSqueryURL = "https://cors-anywhere.herokuapp.com/https://openstates.org/api/v1/legislators/?state=nc&apikey=" + OSAPIKey;

var ppaddressquery = "";

$("#submitpp").on("click", function(event) {
    event.preventDefault();
    $("#ppdumpsite").empty()
    console.log($("#ppaddressline1").val());
    console.log($("#ppaddressline2").val());
    console.log($("#ppinputCity").val());
    console.log($("#ppstates").val());
    console.log($("#ppinputzip").val());
    ppaddressquery = $("#ppaddressline1").val() + " " + $("#ppaddressline2").val() + " " +  $("#ppinputCity").val() + " " +  $("#ppstates").val() + " " +  $("#ppinputzip").val();

    address = ppaddressquery;

    console.log(ppaddressquery);


    var stateInput = ($("#ppstates").val().trim());
    var PPqueryURL = "https://api.propublica.org/congress/v1/members/senate/" + stateInput + "/current.json";





    console.log(PPqueryURL)


    $.ajax({
        url: PPqueryURL,
        headers: {
        "X-API-Key": "TQ2hslbjh61kVID2GwEOjzuQ8BzIauJScUHBfzJa"
        },

        method: "GET",
        
        crossDomain: true
        

    })

          .then(function(response) {

            var party = "";
            // Log the queryURL
            console.log(response);
            console.log(response.results);

            for (i=0; i<response.results.length; i++) {
                console.log(response.results[i]);
                console.log("Name: " + response.results[i].name);
                console.log("URID: " + response.results[i].id);
                if (response.results[i].party === "D") {
                    party = "Democrat";
                console.log("Party: Democrat");
                }
                else if (response.results[i].party === "R") {
                    party = "Republican";
                console.log("Party: Republican");
                }
                else {
                console.log("This is America you free thinking wackjob...");
                }

                console.log("Twitter Handle: " + response.results[i].twitter_id);
                console.log("Up for re-election: " + response.results[i].next_election);
                

            var newrow = $("<div>").addClass("row");

            (newrow).html('<div class="col-sm-3">' + response.results[i].name + '</div><div class="col-sm-3">' + response.results[i].role + '</div><div class="col-sm-3">' + party + '</div><div class="col-sm-3">' + response.results[i].next_election + '</div>')
                
            $("#ppdumpsite").append(newrow);

            };


          });





});

$("#submitos").on("click", function() {
    event.preventDefault();

    $("#osdumpsite").empty()


var OSstateInput = $("#osstates").val().trim().toLowerCase();

    osaddressquery = $("#osaddressline1").val() + " " + $("#osaddressline2").val() + " " +  $("#osinputCity").val() + " " +  $("#osstates").val() + " " +  $("#osinputzip").val();

    address = osaddressquery;

// var OSqueryURL = "https://cors-anywhere.herokuapp.com/https://openstates.org/api/v1/legislators/?state=" + OSstateInput + "&apikey=" + OSAPIKey;

var OSqueryURL = "https://cors-anywhere.herokuapp.com/https://openstates.org/api/v1/legislators/?state=" + OSstateInput + "&apikey=" + OSAPIKey + "&limit=9";




    console.log(OSqueryURL)



$.ajax({
    url: OSqueryURL,
    headers: {
        "X-API-Key": "61090add-67ca-4358-841d-7983d3231aa0",
        },

    method: "GET"
})

      .then(function(instance) {

          console.log(instance)


        // for (i=0; i<instance.length; i++) {
            for (i=0; i<25; i++) {

                console.log(instance[i]);
                console.log("Name: " + instance[i].full_name);
                console.log("URID: " + instance[i].id);
                console.log("Party: " + instance[i].party);


                console.log("Emali: " + instance[i].email);
                console.log("District: " + instance[i].district);
                console.log("Office Address: " + instance[i].office_address);
                console.log("Image REF: " + instance[i].photo_url);

                var newrow = $("<div>").addClass("row");

                var newimage = $("<img>");

                console.log(newimage);

                newimage.attr("src", instance[i].photo_url).attr("style", "width: 180px");

                console.log(newimage);


                (newrow).html('<div class="col-sm-3">' + newimage[0].outerHTML + '</div><div class="col-sm-3">' + instance[i].full_name + '</div><div class="col-sm-3">' + instance[i].party + '</div><div class="col-sm-3">District: ' + instance[i].district + '</div>')
                    
                $("#osdumpsite").append(newrow);

                


            };
          });

      });



      $("#submitgeo").on("click", function(event) {

        event.preventDefault();

            $("#osdumpsite").empty()


        var latitude = $("#latitudeinput").val().trim();

        var longitude = $("#longitudeinput").val().trim();


        var OSqueryURLGEO = "https://cors-anywhere.herokuapp.com/https://openstates.org/api/v1/legislators/geo/?lat=" + latitude + "&long=" + longitude + "&apikey=" + OSAPIKey;

        $.ajax({
            url: OSqueryURLGEO,
            headers: {
                "X-API-Key": "61090add-67ca-4358-841d-7983d3231aa0",
                },

            method: "GET"
        })

            .then(function(geolook) {
                console.log(geolook)
                for (i=0; i<geolook.length; i++) {

                var newrow = $("<div>").addClass("row");

                var newimage = $("<img>");

                console.log(newimage);

                newimage.attr("src", geolook[i].photo_url).attr("style", "width: 180px");

                console.log(newimage);


                (newrow).html('<div class="col-sm-3">' + newimage[0].outerHTML + '</div><div class="col-sm-3">' + geolook[i].full_name + '</div><div class="col-sm-3">' + geolook[i].party + '</div><div class="col-sm-3">District: ' + geolook[i].district + '</div>')
                    
                $("#osdumpsite").append(newrow);

                }
            });

      });

    function initMap() {
            var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 8,
              center: {lat: 35.397, lng: -80}
            });
            var geocoder = new google.maps.Geocoder();
    
            document.getElementById('submit').addEventListener('click', function() {
              geocodeAddress(geocoder, map);
            });
          }
    
          function geocodeAddress(geocoder, resultsMap) {
            // address = document.getElementById('address').value;
            geocoder.geocode({'address': address}, function(results, status) {
                console.log(results);
                console.log(results[0].geometry.bounds);
                //Longtitude
                console.log(results[0].geometry.bounds.b.b);
                //Latitude
                console.log(results[0].geometry.bounds.f.f);

              if (status === 'OK') {
                resultsMap.setCenter(results[0].geometry.location);
                var marker = new google.maps.Marker({
                  map: resultsMap,
                  position: results[0].geometry.location
                });
              } else {
                alert('Geocode was not successful for the following reason: ' + status);
              }
            });
          }
        </script>

        <!--Google Map API-->

        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD4Pa8hRs34M7iiaRMeUylEBAh6nyiNfB8&callback=initMap">
        </script>


</script>
    
</body>
</html>